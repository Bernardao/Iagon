{# src/Cupon/UsuarioBundle/Resources/views/Default/cajaLogin.html.twig #}

{# el usuario está logueado #}
{% if is_granted('ROLE_USUARIO') %}
    {% if app.session.hasFlash('info') %}
        <p class="info">{{ app.session.getFlash('info') }}</p>
    {% endif %}
    
    {% set usuario = app.user %}
    <p>Conectado como {{ usuario.nombre ~ ' ' ~ usuario.apellidos }}</p>
    
    <a href="{{ path('usuario_perfil') }}">Ver mi perfil</a>
    <a href="{{ path('usuario_logout') }}">Cerrar sesión</a>
{% else %}
{# el usuario todavía no ha hecho login #}
    <a class="boton" href="{{ path('usuario_registro') }}">Regístrate</a>
    
    <h2>Accede a tu cuenta</h2>
    <form action="{{ path('usuario_login_check') }}" method="post">
        {% if error is defined %}
            <div>{{ error.message | default('') }}</div>
        {% endif %}
        <label for="login_user">Email</label>
        <input id="login_user" type="text" name="_username" value="{{ last_username | default('') }}" />
        <label for="login_pass">Contraseña</label>
        <input id="login_pass" type="password" name="_password" />

        <input type="submit" value="Entrar" />

        <input type="checkbox" id="no_cerrar" name="_remember_me" checked />
        <label for="no_cerrar">No cerrar sesión</label>
    </form>
{% endif %}
